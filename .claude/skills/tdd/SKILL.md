---
name: tdd
description: t-wadaスタイルのTDD（テスト駆動開発）を実践します。テストファースト、Red-Green-Refactorサイクルでコードを実装する際に使用します
---

# TDD実践スキル

このスキルは、和田卓人（t-wada）氏が推奨するテスト駆動開発（TDD）の5ステップを実践します。

## TDDの基本5ステップ

### 1. テストシナリオのリストを作成

まず、実装したい機能をTODOリストに列挙します：

- 実装したい機能を小さく分割可能なテストケースにする
- TodoWriteツールを使用してテストシナリオを管理

### 2. 「ひとつだけ」選んでテストコードに翻訳し、失敗を確認（Red）

- **一度に複数のテストを書かない**
- テストを実行し、期待通り失敗することを確認
- 失敗メッセージが正しいことを確認

### 3. プロダクトコードを変更してテストを成功させる（Green）

- テストをパスする最小限のコードを書く
- 仮実装でも良い
- すべてのテストが通ることを確認

### 4. 必要に応じてリファクタリング実施（Refactor）

- テストが通った状態で、コードを改善
- 重複の除去、可読性の向上
- テストが引き続きパスすることを確認

### 5. テストリストが空になるまで繰り返す

- 次のテストケースを選択
- ステップ2に戻る

## 実践例

```typescript
// 1. テストリスト作成（TodoWriteツールで管理）
// TODO: getCityByIdが有効なIDで地域を返す
// TODO: getCityByIdが無効なIDでundefinedを返す

// 2. ひとつだけテストを書く（Red）
test('getCityByIdが有効なIDで地域を返す', () => {
  const city = getCityById('tokyo');
  expect(city?.nameJa).toBe('東京');
});
// → 実行して失敗を確認

// 3. 実装してテストを通す（Green）
export function getCityById(id: string) {
  return CITIES.find(city => city.id === id);
}
// → テストが成功

// 4. リファクタリング（必要なら）
// 5. 次のテストへ
```

## スキル実行時の手順

1. ユーザーが実装したい機能を説明したら、テストシナリオのリストを作成
2. TodoWriteツールでテストシナリオを管理
3. 一つずつRed-Green-Refactorサイクルを実行：
   - **Red**: テストを1つだけ書いて、失敗を確認（`npm run test:run`を実行）
   - **Green**: テストを通す最小限の実装（`npm run test:run`で成功を確認）
   - **Refactor**: 必要に応じてリファクタリング（テストが通ることを確認）
4. すべてのテストシナリオが完了するまで繰り返す

## 重要な原則

- **一度に複数のテストを書かない**: 単一テストの原則
- **小さなステップで進む**: テストのやりやすいところから始める
- **必ずRedを確認**: テストが期待通り失敗することを確認してから実装に進む
- **Greenで一旦報告**: テストが通る最小実装ができた時点で報告
- **可読性は後回し**: 最初は動作する汚い状態でOK、抽象化はリファクタリングフェーズで
